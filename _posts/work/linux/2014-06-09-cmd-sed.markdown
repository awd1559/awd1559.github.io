---
layout:     post
title:      "sed"
subtitle:   " \"文本模式匹配\""
date:       2014-06-09 12:00:00
author:     "awd"
header-img: "img/post-bg-2015.jpg"
tags:
    - linux shell
---
sed
1)逐行处理文本
2)把正在处理的行保存到临时缓冲区，称为模式空间
3)执行完sed命令后，将该行发送到屏幕，读取下一行
还有一个暂存缓冲区(8192)，供hH存放，供gG读取

正则表达式是括在斜杠间的模式
sed optoion 'command' filenames
例子：	sed '1,3d' file		#删除1-3行，其他行默认打印，不影响原文件
	sed -n '/[Jj]ohn/p' file#打印符合模式的行，其他行不输出
	
option
-e	允许多项编辑
-f	制定sed脚本
-n	取消默认的输出

command
a\	#在当前行后添加一行和多行
c\	#替换
d	#删除
i\	#在当前行之前插入
h	#模式空间里的内容复制到暂存缓冲区
H	#模式空间里的内容追加到暂存缓冲区
g	#用暂存缓冲区内容覆盖模式空间内容
G	#暂存缓冲区内容追加模式空间内容
l	#列出非打印字符
p	#打印
n	#读入下一行，并从下一条命令而不是第一条命令开始对其处理
q	#退出sed
r	#从文件中读取行到模式空间
!	#对所选行外的所有行应用命令
s	#字符串替换

替换标志
g	#在行内进行全局替换
p	#打印
w	#将行写如文件
x	#交换暂存换种去与模式空间的内容
y	#将字符转化为另一个字符

例子
sed -e '1,3d' -e 's/Hemenway/Jones/' datafile
多重编辑：删除1-3行，将Hemenway替换为Jones

sed '/Suan/r newfile' datafile
匹配模式后，在该行后输出文件newfile中的内容

sed '/north/w newfile' datafile
将模式匹配的行写入文件newfile中

sed '/^north/a \
this will added as next line ----' datafile
匹配模式后，添加一行

sed '/eastern/{n; s/AM/Archie/;}' datafile
匹配模式后，对下一行执行n中的命令
多个命令组成一个命令用{}表示

sed -e '/^north/h' -e '$G' datafile
1)匹配模式后放到暂存缓冲区， 
2)匹配最后一行后，取出holding buffer内容，追加匹配行(本例即最后一行)
